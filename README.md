Money count
==========

Простой пример работы распознавания с помощью подсчета площади фигуры.

## Как работать с этим:

Установить lua 5.1 и пакет lua-gd

Ввести в командной строке:
```
lua money_detect.lua IMG_20150317_164135
```

где последнее слово название файла jpg без формата и точки

Результат:
```
Summa:  63       rub
```
## Алгоритм работы:

0. Чтобы быстрее обработать уменьшаем размер изображения до 640 на 361 (цифры
   взяты с потолка)
1. Чтобы найти закрытые области проходимся по красному спекту и строим по нему
   гистрограмму. В гистрограмме есть точка которая делит все на две массивные
   области, найдя эту точку мы можем бинаризировать (сделать его двухцветным)
   изображение. Эта точка находится через алгоритм Отцу.
2. Чтобы посчитать площади необходимо отметить разными цветами не пересекающиеся
   области, мы это делаем через простой алгоритм маркировки.
3. Теперь считаем площади цветных пятен и записываем площади.
4. Чтобы получить сумму проходимся по массиву площадей и каждой площади
   присваеваем возможное значение монеты в этой площади.
5. Выводим результат.

## Проблемы которые не решены:

0. Так как я не посчитал необходимое расстояние угол для фотографирования, то
   площадь на других фотографиях кроме эталлонной не та, а значит он не
   правильно считает их.
1. Наличие сложной текстуры на фотографии приводит программу в шок и она не
   работает
2. Монеты разного номинала имеют оочень похожие размеры

## Пример работы:

### до:

[before](https://raw.githubusercontent.com/vstebunov/lua-cv-money-count/master/IMG_20150310_210430.jpg)

### после:

[after](https://github.com/vstebunov/lua-cv-money-count/blob/master/IMG_20150310_210430_result.png)
